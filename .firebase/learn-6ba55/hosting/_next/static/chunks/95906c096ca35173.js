(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,37727,e=>{"use strict";let s=(0,e.i(75254).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>s],37727)},14764,e=>{"use strict";let s=(0,e.i(75254).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>s],14764)},47019,e=>{"use strict";var s=e.i(59141);e.i(36180);var t=e.i(98925);let a=async(e,a,i)=>{let r=(0,t.doc)(s.db,"chats",e);(await (0,t.getDoc)(r)).exists()||await (0,t.setDoc)(r,{id:e,userEmail:a,userName:i||a.split("@")[0],lastMessage:"",lastMessageTimestamp:(0,t.serverTimestamp)(),unreadCount:0,userUnreadCount:0})},i=async(e,a,i)=>{let r=(0,t.doc)(s.db,"chats",e),l=(0,t.collection)(r,"messages");await (0,t.addDoc)(l,{text:a,sender:i,timestamp:(0,t.serverTimestamp)()});let n={lastMessage:a,lastMessageTimestamp:(0,t.serverTimestamp)()};"user"===i?n.unreadCount=(0,t.increment)(1):(n.userUnreadCount=(0,t.increment)(1),n.unreadCount=0),await (0,t.updateDoc)(r,n)},r=async e=>{let a=(0,t.doc)(s.db,"chats",e);await (0,t.updateDoc)(a,{userUnreadCount:0})};e.s(["initializeChat",0,a,"markUserMessagesAsRead",0,r,"sendMessage",0,i,"subscribeToAllChats",0,(e,a)=>{let i=(0,t.collection)(s.db,"chats"),r=(0,t.query)(i,(0,t.orderBy)("lastMessageTimestamp","desc"));return(0,t.onSnapshot)(r,s=>{e(s.docs.map(e=>({id:e.id,...e.data()})))},e=>{a?a(e):console.error("Error subscribing to chats:",e)})},"subscribeToChatDoc",0,(e,a)=>{let i=(0,t.doc)(s.db,"chats",e);return(0,t.onSnapshot)(i,e=>{e.exists()?a({id:e.id,...e.data()}):a(null)})},"subscribeToMessages",0,(e,a)=>{let i=(0,t.collection)(s.db,"chats",e,"messages"),r=(0,t.query)(i,(0,t.orderBy)("timestamp","asc"));return(0,t.onSnapshot)(r,e=>{a(e.docs.map(e=>({id:e.id,...e.data()})))})}])},55110,e=>{"use strict";var s=e.i(43476),t=e.i(71645);let a=(0,e.i(75254).default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);var i=e.i(37727),r=e.i(14764),l=e.i(84614),n=e.i(46932),o=e.i(88653),c=e.i(19455),d=e.i(59141);e.i(51718);var u=e.i(18357),m=e.i(47019);function h(){let[e,h]=(0,t.useState)(!1),[x,p]=(0,t.useState)([]),[f,b]=(0,t.useState)(""),[g,w]=(0,t.useState)(!1),[j,y]=(0,t.useState)(null),[v,N]=(0,t.useState)(0),C=(0,t.useRef)(null);(0,t.useEffect)(()=>{let e=(0,u.onAuthStateChanged)(d.auth,async e=>{if(e){y(e),await (0,m.initializeChat)(e.uid,e.email||"Anonymous",e.displayName||void 0);let s=(0,m.subscribeToMessages)(e.uid,e=>{p(e)}),t=(0,m.subscribeToChatDoc)(e.uid,e=>{e&&e.userUnreadCount?N(e.userUnreadCount):N(0)});return()=>{s(),t()}}y(null),p([]),N(0)});return()=>e()},[]),(0,t.useEffect)(()=>{e&&j&&v>0&&((0,m.markUserMessagesAsRead)(j.uid),N(0))},[e,v,j]),(0,t.useEffect)(()=>{C.current&&(C.current.scrollTop=C.current.scrollHeight)},[x,e]);let T=async e=>{if(e.preventDefault(),f.trim()&&j){b("");try{await (0,m.sendMessage)(j.uid,f,"user")}catch(e){console.error("Error sending message:",e)}}};return j?(0,s.jsxs)("div",{className:"fixed bottom-6 right-6 z-50 font-sans",children:[(0,s.jsx)(o.AnimatePresence,{children:e&&(0,s.jsxs)(n.motion.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95},className:"bg-white rounded-2xl shadow-2xl w-80 sm:w-96 overflow-hidden border border-slate-100 flex flex-col h-[500px] mb-4",children:[(0,s.jsxs)("div",{className:"p-4 bg-slate-900 flex justify-between items-center text-white shrink-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),(0,s.jsx)("h3",{className:"font-serif font-semibold",children:"Support Team"})]}),(0,s.jsx)("button",{onClick:()=>h(!1),className:"hover:bg-slate-800 p-1 rounded-full transition-colors",children:(0,s.jsx)(i.X,{className:"w-5 h-5"})})]}),(0,s.jsx)("div",{ref:C,className:"flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50",children:0===x.length?(0,s.jsx)("div",{className:"text-center text-slate-400 text-sm mt-8",children:(0,s.jsx)("p",{children:"Start a conversation with us!"})}):x.map(e=>{var t;return(0,s.jsx)("div",{className:`flex flex-col ${"user"===e.sender?"items-end":"items-start"}`,children:(0,s.jsxs)("div",{className:`max-w-[80%] p-3 rounded-2xl text-sm relative group ${"user"===e.sender?"bg-orange-600 text-white rounded-tr-none":"bg-white text-slate-700 shadow-sm border border-slate-100 rounded-tl-none"}`,children:[(0,s.jsx)("p",{children:e.text}),(0,s.jsx)("div",{className:`text-[10px] mt-1 flex items-center gap-1 ${"user"===e.sender?"text-orange-200 justify-end":"text-slate-400 justify-start"}`,children:(t=e.timestamp)?t.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}).toLowerCase():""})]})},e.id)})}),(0,s.jsxs)("form",{onSubmit:T,className:"p-4 bg-white border-t border-slate-100 shrink-0 flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:f,onChange:e=>b(e.target.value),placeholder:"Type a message...",className:"flex-1 bg-slate-50 border-none rounded-xl px-4 py-2 text-sm focus:ring-2 focus:ring-orange-100 outline-none"}),(0,s.jsx)(c.Button,{type:"submit",size:"icon",disabled:!f.trim(),className:"w-10 h-10 rounded-xl bg-slate-900 hover:bg-orange-600 text-white transition-colors",children:(0,s.jsx)(r.Send,{className:"w-4 h-4"})})]})]})}),!e&&(0,s.jsxs)(n.motion.button,{initial:{scale:0},animate:{scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>h(!0),className:"relative w-14 h-14 bg-slate-900 rounded-full flex items-center justify-center text-white shadow-lg hover:bg-orange-600 transition-colors",children:[j&&v>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center text-[10px] font-bold border-2 border-white animate-bounce",children:v}),(0,s.jsx)(a,{className:"w-7 h-7"})]})]}):(0,s.jsx)("div",{className:"fixed bottom-6 right-6 z-50",children:(0,s.jsx)(o.AnimatePresence,{children:e?(0,s.jsxs)(n.motion.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95},className:"bg-white rounded-2xl shadow-2xl w-80 sm:w-96 overflow-hidden border border-slate-100 flex flex-col h-[500px]",children:[(0,s.jsxs)("div",{className:"p-4 bg-slate-900 flex justify-between items-center text-white",children:[(0,s.jsx)("h3",{className:"font-serif font-semibold",children:"Chat with Support"}),(0,s.jsx)("button",{onClick:()=>h(!1),className:"hover:bg-slate-800 p-1 rounded-full transition-colors",children:(0,s.jsx)(i.X,{className:"w-5 h-5"})})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center p-6 text-center space-y-4",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center text-orange-600",children:(0,s.jsx)(l.User,{className:"w-8 h-8"})}),(0,s.jsx)("p",{className:"text-slate-600",children:"Please sign in to chat with our support team."})]})]}):(0,s.jsx)(n.motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>h(!0),className:"w-14 h-14 bg-slate-900 rounded-full flex items-center justify-center text-white shadow-lg hover:bg-orange-600 transition-colors",children:(0,s.jsx)(a,{className:"w-7 h-7"})})})})}e.s(["default",()=>h],55110)},20304,e=>{e.v(s=>Promise.all(["static/chunks/bc52ff07cf5d3335.js"].map(s=>e.l(s))).then(()=>s(44311)))}]);