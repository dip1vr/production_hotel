(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55436,e=>{"use strict";let s=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>s],55436)},24068,e=>{"use strict";var s=e.i(43476),t=e.i(71645),l=e.i(47019),r=e.i(19455),a=e.i(14764),n=e.i(84614),i=e.i(55436);let d=(0,e.i(75254).default)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);function c(){let[c,o]=(0,t.useState)([]),[x,u]=(0,t.useState)(null),[m,h]=(0,t.useState)([]),[f,b]=(0,t.useState)(""),p=(0,t.useRef)(null),[g,j]=(0,t.useState)(null),[N,v]=(0,t.useState)(null);(0,t.useEffect)(()=>{e.A(76207).then(({auth:e})=>{e.currentUser&&v(e.currentUser.uid)});let s=(0,l.subscribeToAllChats)(e=>{o(e),j(null)},e=>{console.error("Subscription error:",e),"permission-denied"===e.code?j("Permission denied. You are not authorized to view admin chats."):j(e.message)});return()=>s()},[]),(0,t.useEffect)(()=>{if(!x)return;let e=(0,l.subscribeToMessages)(x,e=>{h(e)});return()=>e()},[x]),(0,t.useEffect)(()=>{p.current&&(p.current.scrollTop=p.current.scrollHeight)},[m,x]);let w=async e=>{e.preventDefault(),x&&f.trim()&&(await (0,l.sendMessage)(x,f,"admin"),b(""))},y=e=>e?e.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return(0,s.jsxs)("div",{className:"flex h-[calc(100vh-100px)] bg-slate-50 border border-slate-200 rounded-xl overflow-hidden shadow-sm",children:[g&&(0,s.jsxs)("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded shadow-lg z-50",children:[(0,s.jsx)("p",{className:"font-bold",children:"Error"}),(0,s.jsx)("p",{children:g}),N&&(0,s.jsxs)("p",{className:"text-xs mt-1",children:["Your UID: ",(0,s.jsx)("span",{className:"font-mono bg-red-200 px-1 rounded select-all",children:N})," (Add this to Firestore Rules)"]})]}),(0,s.jsxs)("div",{className:"w-1/3 border-r border-slate-200 bg-white flex flex-col",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-slate-100",children:[(0,s.jsx)("h2",{className:"font-serif font-semibold text-lg text-slate-900 mb-2",children:"Messages"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(i.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),(0,s.jsx)("input",{type:"text",placeholder:"Search conversations...",className:"w-full pl-9 pr-4 py-2 bg-slate-50 rounded-lg text-sm outline-none focus:ring-2 focus:ring-orange-100"})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===c.length?(0,s.jsxs)("div",{className:"p-8 text-center text-slate-400",children:[(0,s.jsx)(d,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,s.jsx)("p",{className:"text-sm",children:"No active conversations"})]}):c.map(e=>(0,s.jsxs)("button",{onClick:()=>u(e.id),className:`w-full p-4 flex items-start gap-3 hover:bg-slate-50 transition-colors border-b border-slate-50 text-left ${x===e.id?"bg-orange-50 hover:bg-orange-50 border-l-4 border-l-orange-500":"border-l-4 border-l-transparent"}`,children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-slate-200 flex items-center justify-center shrink-0",children:(0,s.jsx)(n.User,{className:"w-5 h-5 text-slate-500"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex justify-between items-baseline mb-1",children:[(0,s.jsx)("h3",{className:"font-medium text-slate-900 truncate text-sm",children:e.userName||e.userEmail}),(0,s.jsx)("span",{className:"text-[10px] text-slate-400 shrink-0",children:y(e.lastMessageTimestamp)})]}),(0,s.jsx)("p",{className:`text-xs truncate ${e.unreadCount>0?"font-bold text-slate-800":"text-slate-500"}`,children:e.lastMessage||"Started a chat"})]}),e.unreadCount>0&&(0,s.jsx)("div",{className:"w-5 h-5 bg-orange-500 rounded-full flex items-center justify-center text-[10px] text-white font-bold shrink-0",children:e.unreadCount})]},e.id))})]}),(0,s.jsx)("div",{className:"flex-1 flex flex-col bg-white",children:x?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"p-4 border-b border-slate-100 flex justify-between items-center",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-slate-200 flex items-center justify-center",children:(0,s.jsx)(n.User,{className:"w-5 h-5 text-slate-500"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-slate-900",children:c.find(e=>e.id===x)?.userName||c.find(e=>e.id===x)?.userEmail}),(0,s.jsxs)("span",{className:"text-xs text-green-500 flex items-center gap-1",children:[(0,s.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500"}),"Online"]})]})]})}),(0,s.jsx)("div",{ref:p,className:"flex-1 overflow-y-auto p-6 space-y-4 bg-slate-50/50",children:m.map(e=>(0,s.jsx)("div",{className:`flex ${"admin"===e.sender?"justify-end":"justify-start"}`,children:(0,s.jsxs)("div",{className:`max-w-[70%] p-3 rounded-2xl text-sm shadow-sm ${"admin"===e.sender?"bg-slate-900 text-white rounded-tr-none":"bg-white text-slate-700 border border-slate-100 rounded-tl-none"}`,children:[(0,s.jsx)("p",{children:e.text}),(0,s.jsx)("p",{className:`text-[10px] mt-1 text-right ${(e.sender,"text-slate-400")}`,children:y(e.timestamp)})]})},e.id))}),(0,s.jsxs)("form",{onSubmit:w,className:"p-4 bg-white border-t border-slate-100 flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:f,onChange:e=>b(e.target.value),placeholder:"Type a reply...",className:"flex-1 bg-slate-50 border-none rounded-xl px-4 py-2 text-sm focus:ring-2 focus:ring-orange-100 outline-none"}),(0,s.jsx)(r.Button,{type:"submit",size:"icon",disabled:!f.trim(),className:"bg-slate-900 hover:bg-orange-600 rounded-xl w-10 h-10",children:(0,s.jsx)(a.Send,{className:"w-4 h-4"})})]})]}):(0,s.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-400",children:[(0,s.jsx)(d,{className:"w-16 h-16 mb-4 opacity-20"}),(0,s.jsx)("p",{children:"Select a conversation to start chatting"})]})})]})}e.s(["default",()=>c],24068)},76207,e=>{e.v(e=>Promise.resolve().then(()=>e(59141)))}]);