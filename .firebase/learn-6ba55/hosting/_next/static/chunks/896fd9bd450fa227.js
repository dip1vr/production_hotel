(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,37727,e=>{"use strict";let t=(0,e.i(75254).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>t],37727)},14764,e=>{"use strict";let t=(0,e.i(75254).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],14764)},47019,e=>{"use strict";var t=e.i(59141);e.i(36180);var s=e.i(98925);let a=async(e,a,r)=>{let i=(0,s.doc)(t.db,"chats",e);(await (0,s.getDoc)(i)).exists()||await (0,s.setDoc)(i,{id:e,userEmail:a,userName:r||a.split("@")[0],lastMessage:"",lastMessageTimestamp:(0,s.serverTimestamp)(),unreadCount:0,userUnreadCount:0})},r=async(e,a,r)=>{let i=(0,s.doc)(t.db,"chats",e),l=(0,s.collection)(i,"messages");await (0,s.addDoc)(l,{text:a,sender:r,timestamp:(0,s.serverTimestamp)()});let n={lastMessage:a,lastMessageTimestamp:(0,s.serverTimestamp)()};"user"===r?n.unreadCount=(0,s.increment)(1):(n.userUnreadCount=(0,s.increment)(1),n.unreadCount=0),await (0,s.updateDoc)(i,n)},i=async e=>{let a=(0,s.doc)(t.db,"chats",e);await (0,s.updateDoc)(a,{userUnreadCount:0})};e.s(["initializeChat",0,a,"markUserMessagesAsRead",0,i,"sendMessage",0,r,"subscribeToAllChats",0,(e,a)=>{let r=(0,s.collection)(t.db,"chats"),i=(0,s.query)(r,(0,s.orderBy)("lastMessageTimestamp","desc"));return(0,s.onSnapshot)(i,t=>{e(t.docs.map(e=>({id:e.id,...e.data()})))},e=>{a?a(e):console.error("Error subscribing to chats:",e)})},"subscribeToChatDoc",0,(e,a)=>{let r=(0,s.doc)(t.db,"chats",e);return(0,s.onSnapshot)(r,e=>{e.exists()?a({id:e.id,...e.data()}):a(null)})},"subscribeToMessages",0,(e,a)=>{let r=(0,s.collection)(t.db,"chats",e,"messages"),i=(0,s.query)(r,(0,s.orderBy)("timestamp","asc"));return(0,s.onSnapshot)(i,e=>{a(e.docs.map(e=>({id:e.id,...e.data()})))})}])},55110,e=>{"use strict";var t=e.i(43476),s=e.i(71645);let a=(0,e.i(75254).default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);var r=e.i(37727),i=e.i(14764),l=e.i(84614),n=e.i(46932),o=e.i(88653),c=e.i(19455),d=e.i(59141);e.i(51718);var u=e.i(18357),m=e.i(47019);function h(){let[e,h]=(0,s.useState)(!1),[x,g]=(0,s.useState)([]),[p,f]=(0,s.useState)(""),[b,w]=(0,s.useState)(!1),[v,y]=(0,s.useState)(null),[j,N]=(0,s.useState)(0),C=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=(0,u.onAuthStateChanged)(d.auth,async e=>{if(e){y(e),await (0,m.initializeChat)(e.uid,e.email||"Anonymous",e.displayName||void 0);let t=(0,m.subscribeToMessages)(e.uid,e=>{g(e)}),s=(0,m.subscribeToChatDoc)(e.uid,e=>{e&&e.userUnreadCount?N(e.userUnreadCount):N(0)});return()=>{t(),s()}}y(null),g([]),N(0)});return()=>e()},[]),(0,s.useEffect)(()=>{e&&v&&j>0&&((0,m.markUserMessagesAsRead)(v.uid),N(0))},[e,j,v]),(0,s.useEffect)(()=>{C.current&&(C.current.scrollTop=C.current.scrollHeight)},[x,e]);let T=async e=>{if(e.preventDefault(),p.trim()&&v){f("");try{await (0,m.sendMessage)(v.uid,p,"user")}catch(e){console.error("Error sending message:",e)}}};return v?(0,t.jsxs)("div",{className:"fixed bottom-6 right-6 z-50 font-sans",children:[(0,t.jsx)(o.AnimatePresence,{children:e&&(0,t.jsxs)(n.motion.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95},className:"bg-white rounded-2xl shadow-2xl w-80 sm:w-96 overflow-hidden border border-slate-100 flex flex-col h-[500px] mb-4",children:[(0,t.jsxs)("div",{className:"p-4 bg-slate-900 flex justify-between items-center text-white shrink-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),(0,t.jsx)("h3",{className:"font-serif font-semibold",children:"Support Team"})]}),(0,t.jsx)("button",{onClick:()=>h(!1),className:"hover:bg-slate-800 p-1 rounded-full transition-colors",children:(0,t.jsx)(r.X,{className:"w-5 h-5"})})]}),(0,t.jsx)("div",{ref:C,className:"flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50",children:0===x.length?(0,t.jsx)("div",{className:"text-center text-slate-400 text-sm mt-8",children:(0,t.jsx)("p",{children:"Start a conversation with us!"})}):x.map(e=>{var s;return(0,t.jsx)("div",{className:`flex flex-col ${"user"===e.sender?"items-end":"items-start"}`,children:(0,t.jsxs)("div",{className:`max-w-[80%] p-3 rounded-2xl text-sm relative group ${"user"===e.sender?"bg-orange-600 text-white rounded-tr-none":"bg-white text-slate-700 shadow-sm border border-slate-100 rounded-tl-none"}`,children:[(0,t.jsx)("p",{children:e.text}),(0,t.jsx)("div",{className:`text-[10px] mt-1 flex items-center gap-1 ${"user"===e.sender?"text-orange-200 justify-end":"text-slate-400 justify-start"}`,children:(s=e.timestamp)?s.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}).toLowerCase():""})]})},e.id)})}),(0,t.jsxs)("form",{onSubmit:T,className:"p-4 bg-white border-t border-slate-100 shrink-0 flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:p,onChange:e=>f(e.target.value),placeholder:"Type a message...",className:"flex-1 bg-slate-50 border-none rounded-xl px-4 py-2 text-sm focus:ring-2 focus:ring-orange-100 outline-none"}),(0,t.jsx)(c.Button,{type:"submit",size:"icon",disabled:!p.trim(),className:"w-10 h-10 rounded-xl bg-slate-900 hover:bg-orange-600 text-white transition-colors",children:(0,t.jsx)(i.Send,{className:"w-4 h-4"})})]})]})}),!e&&(0,t.jsxs)(n.motion.button,{initial:{scale:0},animate:{scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>h(!0),className:"relative w-14 h-14 bg-slate-900 rounded-full flex items-center justify-center text-white shadow-lg hover:bg-orange-600 transition-colors",children:[v&&j>0&&(0,t.jsx)("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center text-[10px] font-bold border-2 border-white animate-bounce",children:j}),(0,t.jsx)(a,{className:"w-7 h-7"})]})]}):(0,t.jsx)("div",{className:"fixed bottom-6 right-6 z-50",children:(0,t.jsx)(o.AnimatePresence,{children:e?(0,t.jsxs)(n.motion.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95},className:"bg-white rounded-2xl shadow-2xl w-80 sm:w-96 overflow-hidden border border-slate-100 flex flex-col h-[500px]",children:[(0,t.jsxs)("div",{className:"p-4 bg-slate-900 flex justify-between items-center text-white",children:[(0,t.jsx)("h3",{className:"font-serif font-semibold",children:"Chat with Support"}),(0,t.jsx)("button",{onClick:()=>h(!1),className:"hover:bg-slate-800 p-1 rounded-full transition-colors",children:(0,t.jsx)(r.X,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center p-6 text-center space-y-4",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center text-orange-600",children:(0,t.jsx)(l.User,{className:"w-8 h-8"})}),(0,t.jsx)("p",{className:"text-slate-600",children:"Please sign in to chat with our support team."})]})]}):(0,t.jsx)(n.motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>h(!0),className:"w-14 h-14 bg-slate-900 rounded-full flex items-center justify-center text-white shadow-lg hover:bg-orange-600 transition-colors",children:(0,t.jsx)(a,{className:"w-7 h-7"})})})})}e.s(["default",()=>h],55110)},42222,e=>{"use strict";var t=e.i(71645),s=e.i(59141);e.i(36180);var a=e.i(98925),r=e.i(32341);function i(){let{user:e}=(0,r.useAuth)(),i=(0,t.useRef)(!1);return(0,t.useEffect)(()=>{i.current||(async()=>{try{let t="has_logged_visit_v1";if(sessionStorage.getItem(t))return;let r="unknown";try{let e=await fetch("https://api.ipify.org?format=json");r=(await e.json()).ip}catch(e){console.error("Failed to fetch IP",e)}let l=localStorage.getItem("visitor_id");l||(l=crypto.randomUUID(),localStorage.setItem("visitor_id",l));let n=navigator.userAgent,o=navigator.platform,c=`${window.screen.width}x${window.screen.height}`;await (0,a.addDoc)((0,a.collection)(s.db,"site_visits"),{visitorId:l,ip:r,userAgent:n,platform:o,screenResolution:c,userId:e?.uid||null,userEmail:e?.email||null,timestamp:(0,a.serverTimestamp)(),path:window.location.pathname,referrer:document.referrer||null}),sessionStorage.setItem(t,"true"),i.current=!0}catch(e){console.error("Error logging visit:",e)}})()},[e]),null}e.s(["VisitorTracker",()=>i])},20304,e=>{e.v(t=>Promise.all(["static/chunks/01c4ada661225704.js"].map(t=>e.l(t))).then(()=>t(44311)))}]);